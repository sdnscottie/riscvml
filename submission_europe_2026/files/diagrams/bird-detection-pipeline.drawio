<mxfile host="app.diagrams.net" modified="2026-02-25T00:00:00.000Z" agent="draw.io" version="24.0.0" type="device">
  <diagram id="bird-pipeline" name="Bird Detection Pipeline">
    <mxGraphModel dx="1200" dy="900" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1100" pageHeight="850" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Title -->
        <mxCell id="title" value="&lt;b&gt;Capstone: Bird Detection Pipeline on ESP32-P4&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=18;fontColor=#1a1a1a;" vertex="1" parent="1">
          <mxGeometry x="250" y="15" width="500" height="40" as="geometry"/>
        </mxCell>

        <!-- Legend -->
        <mxCell id="legend-rust" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8302B;strokeColor=#B71C1C;arcSize=20;" vertex="1" parent="1">
          <mxGeometry x="730" y="20" width="20" height="14" as="geometry"/>
        </mxCell>
        <mxCell id="legend-rust-label" value="&lt;font style=&quot;font-size:10px&quot;&gt;Rust-owned&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="755" y="15" width="80" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="legend-ffi" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#424242;strokeColor=#212121;arcSize=20;" vertex="1" parent="1">
          <mxGeometry x="840" y="20" width="20" height="14" as="geometry"/>
        </mxCell>
        <mxCell id="legend-ffi-label" value="&lt;font style=&quot;font-size:10px&quot;&gt;ESP-IDF via FFI&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="865" y="15" width="100" height="25" as="geometry"/>
        </mxCell>

        <!-- Phase 1: Camera → ISP → Display -->
        <mxCell id="phase1-label" value="&lt;b&gt;&lt;font color=&quot;#B71C1C&quot; style=&quot;font-size:12px&quot;&gt;PHASE 1 — Capture &amp; Preview&lt;/font&gt;&lt;/b&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="60" y="60" width="220" height="25" as="geometry"/>
        </mxCell>

        <mxCell id="camera" value="&lt;b&gt;&lt;font color=&quot;#ffffff&quot;&gt;MIPI-CSI Camera&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;font color=&quot;#ffcdd2&quot; style=&quot;font-size:10px&quot;&gt;Camera Controller Driver&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#424242;strokeColor=#212121;arcSize=12;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="95" width="200" height="55" as="geometry"/>
        </mxCell>

        <mxCell id="arrow-cam-isp" value="" style="endArrow=block;endFill=1;strokeColor=#E8302B;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="160" y="150" as="sourcePoint"/>
            <mxPoint x="160" y="180" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="isp" value="&lt;b&gt;&lt;font color=&quot;#ffffff&quot;&gt;ISP Pipeline&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;font color=&quot;#ffcdd2&quot; style=&quot;font-size:10px&quot;&gt;White balance, Auto-exposure&lt;br&gt;Demosaicing, Color correction&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#424242;strokeColor=#212121;arcSize=12;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="180" width="200" height="65" as="geometry"/>
        </mxCell>

        <mxCell id="arrow-isp-dma" value="&lt;font style=&quot;font-size:9px&quot; color=&quot;#666666&quot;&gt;DMA transfer&lt;/font&gt;" style="endArrow=block;endFill=1;strokeColor=#E8302B;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="160" y="245" as="sourcePoint"/>
            <mxPoint x="160" y="280" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="display" value="&lt;b&gt;&lt;font color=&quot;#ffffff&quot;&gt;MIPI-DSI Display&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;font color=&quot;#ef9a9a&quot; style=&quot;font-size:10px&quot;&gt;Live preview (30–60 FPS)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8302B;strokeColor=#B71C1C;arcSize=12;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="280" width="200" height="50" as="geometry"/>
        </mxCell>

        <!-- Phase 2: ML Inference -->
        <mxCell id="phase2-label" value="&lt;b&gt;&lt;font color=&quot;#B71C1C&quot; style=&quot;font-size:12px&quot;&gt;PHASE 2 — ML Inference&lt;/font&gt;&lt;/b&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="370" y="60" width="200" height="25" as="geometry"/>
        </mxCell>

        <!-- Branch arrow from ISP to PPA -->
        <mxCell id="arrow-isp-ppa" value="&lt;font style=&quot;font-size:9px&quot; color=&quot;#666666&quot;&gt;frame fork&lt;/font&gt;" style="endArrow=block;endFill=1;strokeColor=#E8302B;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="260" y="212" as="sourcePoint"/>
            <mxPoint x="370" y="122" as="targetPoint"/>
            <Array as="points">
              <mxPoint x="320" y="212"/>
              <mxPoint x="320" y="122"/>
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="ppa" value="&lt;b&gt;&lt;font color=&quot;#ffffff&quot;&gt;PPA — Downscale&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;font color=&quot;#ffcdd2&quot; style=&quot;font-size:10px&quot;&gt;Hardware-accelerated resize&lt;br&gt;to model input resolution&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#424242;strokeColor=#212121;arcSize=12;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="370" y="95" width="210" height="65" as="geometry"/>
        </mxCell>

        <mxCell id="arrow-ppa-ml" value="" style="endArrow=block;endFill=1;strokeColor=#E8302B;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="475" y="160" as="sourcePoint"/>
            <mxPoint x="475" y="195" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="espdl" value="&lt;b&gt;&lt;font color=&quot;#ffffff&quot; style=&quot;font-size:13px&quot;&gt;esp-dl Inference&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;font color=&quot;#ffcdd2&quot; style=&quot;font-size:10px&quot;&gt;Quantized object detection&lt;br&gt;128-bit vector acceleration&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#424242;strokeColor=#E8302B;strokeWidth=2;arcSize=12;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="370" y="195" width="210" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="arrow-ml-overlay" value="" style="endArrow=block;endFill=1;strokeColor=#E8302B;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="475" y="265" as="sourcePoint"/>
            <mxPoint x="475" y="300" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="overlay" value="&lt;b&gt;&lt;font color=&quot;#ffffff&quot;&gt;PPA Alpha Blend&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;font color=&quot;#ef9a9a&quot; style=&quot;font-size:10px&quot;&gt;Bounding box overlay on display&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8302B;strokeColor=#B71C1C;arcSize=12;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="370" y="300" width="210" height="50" as="geometry"/>
        </mxCell>

        <!-- Phase 3: Tracking & Recording -->
        <mxCell id="phase3-label" value="&lt;b&gt;&lt;font color=&quot;#B71C1C&quot; style=&quot;font-size:12px&quot;&gt;PHASE 3 — Track &amp; Record&lt;/font&gt;&lt;/b&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="700" y="60" width="210" height="25" as="geometry"/>
        </mxCell>

        <!-- Arrow from esp-dl to servo -->
        <mxCell id="arrow-ml-servo" value="&lt;font style=&quot;font-size:9px&quot; color=&quot;#666666&quot;&gt;detection coords&lt;/font&gt;" style="endArrow=block;endFill=1;strokeColor=#E8302B;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="580" y="215" as="sourcePoint"/>
            <mxPoint x="700" y="115" as="targetPoint"/>
            <Array as="points">
              <mxPoint x="650" y="215"/>
              <mxPoint x="650" y="115"/>
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="servo" value="&lt;b&gt;&lt;font color=&quot;#ffffff&quot;&gt;PCA9685 Servos&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;font color=&quot;#ef9a9a&quot; style=&quot;font-size:10px&quot;&gt;Pan/tilt camera tracking&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8302B;strokeColor=#B71C1C;arcSize=12;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="700" y="95" width="200" height="50" as="geometry"/>
        </mxCell>

        <!-- Arrow from ISP to H.264 -->
        <mxCell id="arrow-isp-h264" value="&lt;font style=&quot;font-size:9px&quot; color=&quot;#666666&quot;&gt;full-res frames&lt;/font&gt;" style="endArrow=block;endFill=1;strokeColor=#E8302B;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="260" y="200" as="sourcePoint"/>
            <mxPoint x="700" y="200" as="targetPoint"/>
            <Array as="points">
              <mxPoint x="320" y="200"/>
              <mxPoint x="320" y="385"/>
              <mxPoint x="650" y="385"/>
              <mxPoint x="650" y="200"/>
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="h264" value="&lt;b&gt;&lt;font color=&quot;#ffffff&quot;&gt;H.264 Hardware Encoder&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;font color=&quot;#ffcdd2&quot; style=&quot;font-size:10px&quot;&gt;1080p@30fps, zero-copy&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#424242;strokeColor=#212121;arcSize=12;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="700" y="180" width="200" height="50" as="geometry"/>
        </mxCell>

        <mxCell id="arrow-h264-c6" value="" style="endArrow=block;endFill=1;strokeColor=#E8302B;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="800" y="230" as="sourcePoint"/>
            <mxPoint x="800" y="265" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="c6-companion" value="&lt;b&gt;&lt;font color=&quot;#ffffff&quot;&gt;ESP32-C6 Companion&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;font color=&quot;#ef9a9a&quot; style=&quot;font-size:10px&quot;&gt;Wi-Fi 6 via ESP-Hosted/SDIO&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8302B;strokeColor=#B71C1C;arcSize=12;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="700" y="265" width="200" height="50" as="geometry"/>
        </mxCell>

        <mxCell id="arrow-c6-cloud" value="" style="endArrow=block;endFill=1;strokeColor=#E8302B;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="800" y="315" as="sourcePoint"/>
            <mxPoint x="800" y="350" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="cloud" value="&lt;b&gt;&lt;font color=&quot;#ffffff&quot;&gt;MQTT Alerts + RTSP Stream&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8302B;strokeColor=#B71C1C;arcSize=12;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="700" y="350" width="200" height="40" as="geometry"/>
        </mxCell>

        <!-- SQLite Database -->
        <mxCell id="arrow-ml-sqlite" value="&lt;font style=&quot;font-size:9px&quot; color=&quot;#666666&quot;&gt;detection results&lt;/font&gt;" style="endArrow=block;endFill=1;strokeColor=#E8302B;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="475" y="350" as="sourcePoint"/>
            <mxPoint x="475" y="390" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="sqlite" value="&lt;b&gt;&lt;font color=&quot;#ffffff&quot;&gt;riscvml_detect.db&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;font color=&quot;#ef9a9a&quot; style=&quot;font-size:10px&quot;&gt;SQLite3 — detections table:&lt;br&gt;species, confidence, bbox, timestamp&lt;br&gt;bird_led_colors table:&lt;br&gt;species → RGB mapping&lt;/font&gt;" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=8;fillColor=#E8302B;strokeColor=#B71C1C;arcSize=12;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="370" y="390" width="210" height="85" as="geometry"/>
        </mxCell>

        <!-- RGB LED indicator -->
        <mxCell id="arrow-sqlite-led" value="&lt;font style=&quot;font-size:9px&quot; color=&quot;#666666&quot;&gt;color lookup&lt;/font&gt;" style="endArrow=block;endFill=1;strokeColor=#E8302B;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="160" y="370" as="sourcePoint"/>
            <mxPoint x="160" y="410" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <!-- Arrow from esp-dl to LED area -->
        <mxCell id="arrow-ml-led" value="&lt;font style=&quot;font-size:9px&quot; color=&quot;#666666&quot;&gt;species ID&lt;/font&gt;" style="endArrow=block;endFill=1;strokeColor=#E8302B;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="370" y="240" as="sourcePoint"/>
            <mxPoint x="260" y="350" as="targetPoint"/>
            <Array as="points">
              <mxPoint x="290" y="240"/>
              <mxPoint x="290" y="350"/>
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="led-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8302B;strokeColor=#B71C1C;arcSize=12;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="350" width="200" height="70" as="geometry"/>
        </mxCell>
        <mxCell id="led-title" value="&lt;b&gt;&lt;font color=&quot;#ffffff&quot;&gt;RGB LED Indicator&lt;/font&gt;&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="95" y="352" width="130" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="led-detail" value="&lt;font color=&quot;#ffebee&quot; style=&quot;font-size:10px&quot;&gt;&lt;i&gt;Visual species identification&lt;br&gt;Color mapped per bird type&lt;/i&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="80" y="378" width="170" height="35" as="geometry"/>
        </mxCell>
        <!-- RGB dots to visually indicate LED colors -->
        <mxCell id="led-dot-r" value="" style="ellipse;whiteSpace=wrap;html=1;fillColor=#ff1744;strokeColor=none;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="113" y="413" width="12" height="12" as="geometry"/>
        </mxCell>
        <mxCell id="led-dot-g" value="" style="ellipse;whiteSpace=wrap;html=1;fillColor=#00e676;strokeColor=none;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="133" y="413" width="12" height="12" as="geometry"/>
        </mxCell>
        <mxCell id="led-dot-b" value="" style="ellipse;whiteSpace=wrap;html=1;fillColor=#2979ff;strokeColor=none;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="153" y="413" width="12" height="12" as="geometry"/>
        </mxCell>

        <!-- Arrow from LED to SQLite for color lookup -->
        <mxCell id="arrow-led-db" value="&lt;font style=&quot;font-size:9px&quot; color=&quot;#666666&quot;&gt;bird_led_colors&lt;/font&gt;" style="endArrow=block;endFill=1;strokeColor=#E8302B;strokeWidth=2;dashed=1;dashPattern=4 4;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="260" y="400" as="sourcePoint"/>
            <mxPoint x="370" y="430" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <!-- Async Rust bar at bottom -->
        <mxCell id="async-bar" value="&lt;b&gt;&lt;font color=&quot;#ffffff&quot; style=&quot;font-size:12px&quot;&gt;Embassy Async Runtime — Rust Ownership Model — Zero-Copy Buffer Flow&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1a1a1a;strokeColor=#E8302B;strokeWidth=2;arcSize=20;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="500" width="840" height="35" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
